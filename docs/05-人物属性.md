# 天下MUD - 人物属性系统

## 核心文件

**属性系统**: `/feature/attribute.c`

## 六大基础属性

### 1. STR - 力量/臂力

**函数**: `query_str()`

**计算公式**:
```c
基础值 + force_factor + apply/strength
```

**作用**:
- 影响物理攻击力
- 影响负重能力
- 影响某些武功威力
- 拳掌类武功的重要属性

**提升方式**:
- 装备加成 (apply/strength)
- 内功修炼 (force_factor)
- 某些药物
- 特殊任务奖励

### 2. COR - 勇气/胆识

**函数**: `query_cor()`

**计算公式**:
```c
基础值 + bellicosity/50 + apply/courage
```

**作用**:
- 影响战斗意志
- 影响面对强敌时的表现
- 影响某些特殊技能
- 影响战斗中的士气

**提升方式**:
- 战斗经历 (bellicosity)
- 装备加成 (apply/courage)
- 特殊修炼

### 3. INT - 智力/悟性

**函数**: `query_int()`

**计算公式**:
```c
基础值 + apply/intelligence
```

**作用**:
- 影响技能学习速度
- 影响技能上限
- 学习绝学的必要条件 (如独孤九剑需要31+)
- 影响读书识字效率

**重要性**:
- 最关键的成长属性
- 高悟性可以更快掌握武功
- 某些绝学有悟性门槛

**提升方式**:
- 装备加成 (apply/intelligence)
- 禅定修炼
- 读书学习
- 特殊机缘

### 4. PER - 魅力/容貌

**函数**: `query_per()`

**计算公式**:
```c
基础值 + apply/personality
```

**作用**:
- 影响社交互动
- 影响NPC好感度
- 影响某些特殊任务
- 影响买卖价格

**提升方式**:
- 装备加成 (apply/personality)
- 特殊物品
- 美容类道具

### 5. CON - 体质/根骨

**函数**: `query_con()`

**计算公式**:
```c
基础值 + apply/constitution
```

**作用**:
- 影响生命值上限 (max_kee)
- 影响耐力恢复速度
- 影响抗毒能力
- 影响内功修炼效果

**重要性**:
- 生存能力的基础
- 长期战斗的保障

**提升方式**:
- 装备加成 (apply/constitution)
- 内功修炼
- 药物强化
- 特殊体质改造

### 6. KAR - 福缘/机缘

**函数**: `query_kar()`

**计算公式**:
```c
基础值 + apply/karma
```

**作用**:
- 影响幸运度
- 影响奇遇触发概率
- 影响掉落品质
- 影响关键时刻的成败

**特殊性**:
- 最神秘的属性
- 难以直接提升
- 影响深远但不明显

**提升方式**:
- 装备加成 (apply/karma)
- 做善事积德
- 特殊机缘
- 某些任务奖励

## 战斗相关属性

### 生命值系统

**max_kee** - 最大生命值:
- 受体质 (con) 影响
- 受等级影响
- 受内功影响
- 可通过装备增加

**kee** - 当前生命值:
- 战斗中会降低
- 休息或服药恢复
- 归零则死亡

### 精神值系统

**max_gin** - 最大精神值:
- 影响技能使用
- 影响战斗持久力
- 受悟性影响

**gin** - 当前精神值:
- 使用技能消耗
- 休息恢复
- 不足则无法使用技能

### 精力值系统

**max_sen** - 最大精力值:
- 影响行动能力
- 影响战斗效率

**sen** - 当前精力值:
- 战斗和移动消耗
- 休息和食物恢复
- 不足则行动受限

### 内力系统

**max_force** - 最大内力:
- 内功修炼的成果
- 影响武功威力
- 受内功等级影响

**force** - 当前内力:
- 使用武功招式消耗
- 运功恢复
- 服用丹药恢复

**force_factor** - 内力系数:
- 内功深厚程度
- 影响力量属性
- 影响武功威力

## 经验系统

### combat_exp - 战斗经验

**作用**:
- 衡量整体实力
- 影响技能上限
- 决定可挑战的对手
- 门派晋升依据

**获取方式**:
- 战斗胜利
- 完成任务
- 杀死NPC/怪物
- 特殊事件

**等级对照**:
```
新手: 0 - 10,000
入门: 10,000 - 50,000
初窥门径: 50,000 - 100,000
小有所成: 100,000 - 200,000
江湖好手: 200,000 - 400,000
一流高手: 400,000 - 800,000
绝顶高手: 800,000 - 2,000,000
武林宗师: 2,000,000 - 5,000,000
传说人物: 5,000,000+
```

## 技能相关属性

### skills - 技能列表

**数据结构**: mapping
```c
skills = ([
    "unarmed": 100,    // 拳法100级
    "sword": 80,       // 剑法80级
    "force": 120,      // 内功120级
    ...
])
```

### learned - 技能经验

**数据结构**: mapping
```c
learned = ([
    "unarmed": 256,    // 拳法经验256
    "sword": 180,      // 剑法经验180
    ...
])
```

**作用**:
- 累积到一定值可升级
- 通过战斗和练习增加

### skill_map - 技能映射

**数据结构**: mapping
```c
skill_map = ([
    "unarmed": "luohan-quan",  // 拳法映射到罗汉拳
    "sword": "dugu-sword",     // 剑法映射到独孤九剑
    ...
])
```

**作用**:
- 使用高级武功提升基础技能
- 实现武功传承

## 身份属性

### name - 姓名

- 角色的名字
- 唯一标识

### id - 识别ID

- 游戏内部识别码
- 用于命令交互

### title - 称号

- 显示在名字前
- 如"少林寺第37代弟子"
- 可自定义

### family - 门派信息

**数据结构**: mapping
```c
family = ([
    "family_name": "少林寺",
    "generation": 37,
    "master_name": "空正",
    ...
])
```

### gender - 性别

- "男性" 或 "女性"
- 影响某些装备和任务

### age - 年龄

- 角色年龄
- 随时间增长
- 影响某些事件

## 装备加成系统

### apply 机制

装备可以提供各种属性加成：

- **apply/strength** - 力量加成
- **apply/intelligence** - 悟性加成
- **apply/constitution** - 体质加成
- **apply/courage** - 勇气加成
- **apply/personality** - 魅力加成
- **apply/karma** - 福缘加成
- **apply/armor** - 防御加成
- **apply/damage** - 攻击加成

### 装备类型

**武器**:
- 剑、刀、枪、棍等
- 影响攻击力和攻击方式

**防具**:
- 头盔、铠甲、靴子等
- 影响防御力

**饰品**:
- 戒指、项链等
- 提供特殊属性加成

## 状态属性

### 中毒状态

- **poison** - 中毒程度
- 持续扣血
- 需要解毒

### 受伤状态

- **wound** - 伤势
- 影响战斗力
- 需要疗伤

### 疲劳状态

- **tiredness** - 疲劳度
- 影响行动效率
- 需要休息

## 特殊属性

### bellicosity - 战斗性

- 影响勇气属性
- 通过战斗提升

### 门派特殊属性

**少林**:
- **yjj_level** - 易筋经重数
- 影响武功威力加成

**华山**:
- **sword_type** - 剑宗/气宗
- 决定武学路线

**唐门**:
- **poison_level** - 用毒水平
- 影响毒药效果

## 属性成长

### 初始属性

新角色创建时的基础属性：
- 所有属性通常在15-20之间
- 可以有一定的随机浮动
- 不同种族可能有差异

### 属性提升途径

1. **装备加成**:
   - 最直接的提升方式
   - 可随时更换

2. **内功修炼**:
   - 长期稳定的提升
   - 主要影响力量和体质

3. **药物强化**:
   - 临时或永久提升
   - 如增力丹、洗髓丹等

4. **任务奖励**:
   - 完成特殊任务获得
   - 通常是永久性提升

5. **特殊机缘**:
   - 遇到奇遇
   - 如跳崖得秘籍等

### 属性上限

- 普通属性上限通常为100
- 通过特殊途径可以突破
- 顶级高手可达150+

## 属性查看

### 查看命令

- **score** - 查看基本属性
- **hp** - 查看生命/内力状态
- **skills** - 查看技能列表
- **cha** - 查看详细资料

### 显示内容

```
姓名: 张三
门派: 少林寺第37代弟子
年龄: 25岁
性别: 男性

力量: 45  勇气: 38
悟性: 32  魅力: 28
体质: 42  福缘: 25

生命: 1200/1200
内力: 800/800
精神: 600/600
精力: 500/500

战斗经验: 350,000
```

## 属性对战斗的影响

### 攻击力计算

```
攻击力 = 力量 × 技能等级 × 武器加成 × 内力系数
```

### 防御力计算

```
防御力 = 体质 × 防御技能 × 装甲加成
```

### 命中率

- 受敏捷影响
- 受技能等级影响
- 受对手防御影响

### 闪避率

- 受身法技能影响
- 受轻功等级影响
- 受负重影响

## 属性平衡建议

### 力量型

- 高力量、高体质
- 适合近战搏击
- 拳掌、刀剑流派

### 技巧型

- 高悟性、高敏捷
- 适合剑法、轻功
- 华山、武当等

### 内功型

- 高悟性、高体质
- 适合修炼内功
- 少林、全真等

### 平衡型

- 各属性均衡发展
- 适应性强
- 发展多样化

## 总结

天下MUD的属性系统非常完善，包括：
- 6大基础属性全面影响角色能力
- 战斗属性决定生存和战斗力
- 经验系统提供成长目标
- 装备系统提供灵活的强化途径
- 门派特殊属性增加多样性

合理分配和提升属性，是成为武林高手的关键。
